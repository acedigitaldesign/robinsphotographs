"use strict";var EFORM={prices:{restoration:29,colour:{Yes:15,No:0},prints:{Yes:9,No:0},speed:{Standard:0,Priority:15}},init:function(){EFORM.addListeners(),EFORM.amendOptionLabels(),EFORM.localisePrices(),EFORM.amendSubmitButtonCTA()},addListeners:function(){var t=document.querySelector(".fileinput-button");t.addEventListener("click",EFORM.assignColSpan100ToUploadButton),t.addEventListener("click",EFORM.monitorImageUploadProgress),t.addEventListener("click",EFORM.hideUploadErrorMsg);for(var e=document.querySelectorAll("#ipt_fsqm_form_6_button_container .primary-button"),r=0;r<e.length;r++)e[r].addEventListener("click",EFORM.revealSubmitButton);for(var n=document.querySelectorAll(".eform-label-with-tabindex"),a=0;a<n.length;a++);},monitorImageUploadProgress:function(){jQuery(document).ajaxStart((function(){for(var t=document.querySelectorAll("#ipt_fsqm_form_6_button_container .ipt_uif_button"),e=0;e<t.length;e++)t[e].classList.add("ui-button-disabled"),t[e].classList.add("ui-state-disabled"),t[e].setAttribute("disabled","")})),jQuery(document).ajaxStop((function(){for(var t=document.querySelectorAll("#ipt_fsqm_form_6_button_container .ipt_uif_button"),e=0;e<t.length;e++)t[e].classList.remove("ui-button-disabled"),t[e].classList.remove("ui-state-disabled"),t[e].removeAttribute("disabled");EFORM.updateQuantity()}))},updateQuantity:function(){var t=EFORM.getQuantity();document.querySelector("#ipt_fsqm_form_6_freetype_9_value").value=t},getQuantity:function(){var t=document.querySelector("#ipt_fsqm_form_6_freetype_9_value"),e=document.querySelectorAll(".ipt_fsqm_fileuploader_list .files tr").length,r=parseInt(t.getAttribute("max")),n="";return e<=r?n=e:e>r&&(n=r),n},assignColSpan100ToUploadButton:function(){jQuery(".ipt_fsqm_fileuploader_list thead > tr > td").attr("colspan",100)},amendOptionLabels:function(){var t={Colour:{panelID:EFORM.getPanelID("Colour"),option1:"No, restore only",option2:'Yes, restore and colourise<div class="eform__price-qualifier">(+'+EFORM.getPriceHTML(EFORM.prices.colour.Yes)+' per photo)</div><div class="eform__popular-flag">Popular</div>'},Prints:{panelID:EFORM.getPanelID("Prints"),option1:"No, digital only",option2:'Yes, digital and prints<div class="eform__price-qualifier">(+'+EFORM.getPriceHTML(EFORM.prices.prints.Yes)+" per print)</div>"},Sizes:{panelID:EFORM.getPanelID("Prints"),label:"Please select your desired photo print sizes:"},Speed:{panelID:EFORM.getPanelID("Speed"),option1:"Standard: 7-10 days",option2:'Priority: 3-5 days<div class="eform__price-qualifier">(+'+EFORM.getPriceHTML(EFORM.prices.speed.Priority)+' per photo)</div><div class="eform__popular-flag">Popular</div>'}};for(var e in t){var r=document.getElementById(t[e].panelID);if("Sizes"==e){var n=r.querySelector(".ipt-eform-repeatable-container .ipt_uif_container_label");jQuery(n).html(t[e].label)}else{var a=r.querySelectorAll(".ipt_uif_thumbselect_wrap .ui-widget-header");jQuery(a[0]).html(t[e].option1),jQuery(a[1]).html(t[e].option2)}}},getPanelID:function(t){for(var e=document.querySelectorAll(".ipt_fsqm_form_tab_panel"),r=0;r<e.length;r++){if(e[r].querySelector(".ipt_fsqm_main_heading").innerText.replace(/\s/g,"")==t)return e[r].getAttribute("id")}},getPriceHTML:function(t){var e='<span class="eform__currency-symbol" data-currency-symbol>Â£</span>';return e+='<span class="eform__price" data-currency-total>'+parseFloat(t)+"</span>"},localisePrices:function(){var t=TOOLBOX.getCookie("wmc_current_currency");if("GBP"!=t){var e=document.querySelectorAll("[data-currency-symbol]"),r=document.querySelectorAll("[data-currency-total]");for(var n in window.exchange_rates)if(n==t){for(var a=0;a<e.length;a++)e[a].innerHTML=window.exchange_rates[n].currencySymbol;for(var i=0;i<r.length;i++){var o=parseFloat(r[i].innerHTML)*window.exchange_rates[n].rate;r[i].innerHTML=(Math.round(100*(o+Number.EPSILON))/100).toFixed(2)}}}},localiseTotalPricePerPhoto:function(){var t=TOOLBOX.getCookie("wmc_current_currency");if("GBP"!=t){var e=document.getElementById(EFORM.getPanelID("Review")).querySelector(".ipt_uif_mathematical_input"),r=document.querySelector(".ipt_uif_mathematical_span"),n=function(n){n==t&&setTimeout((function(){var t=parseFloat(e.getAttribute("value"))*window.exchange_rates[n].rate;r.innerHTML=(Math.round(100*(t+Number.EPSILON))/100).toFixed(2)}),10)};for(var a in window.exchange_rates)n(a)}},amendSubmitButtonCTA:function(){var t=document.querySelector(".ipt_fsqm_form_button_submit");t.textContent="Add to Cart",t.classList.add("icon-shopping-cart-empty"),t.classList.add("icon-nudge-top-n2")},revealSubmitButton:function(){var t=EFORM.getFinalPanel(),e=document.querySelector(".ipt_fsqm_form_button_next"),r=document.querySelector(".ipt_fsqm_form_button_submit");setTimeout((function(){"false"==t.getAttribute("aria-hidden")?(e.setAttribute("style","display: none;"),r.setAttribute("style","display: block;")):(e.setAttribute("style","display: block;"),r.setAttribute("style","display: none;"))}),30)},initQuantityInputFocus:function(){var t=document.querySelector("#ipt_fsqm_form_6_mcq_9 input"),e=0,r=setInterval((function(){t.focus(),t.setAttribute("data-focus-visible-added",""),t.classList.add("focus-visible"),10==e++&&window.clearInterval(r)}),500)},hideUploadErrorMsg:function(){jQuery(".ipt_fsqm_file_upload_6_6__uploader_wrapformError").click()},getFinalPanel:function(){var t=document.querySelectorAll(".ipt_fsqm_form_tab_panel");return t[t.length-1]}};jQuery(document).ready((function(){EFORM.init()}));var EF_PROGRESS_BAR={init:function(){var t=document.querySelector("[data-eform-progress-bar]"),e=document.querySelectorAll(".ipt_fsqm_form_tab_panel"),r=EF_PROGRESS_BAR.getSectionHeadings(e),n=[];EF_PROGRESS_BAR.addListeners();for(var a=0;a<e.length;a++)n.push(EF_PROGRESS_BAR.buildStep(a,r[a],e.length));for(var i=0;i<n.length;i++)t.appendChild(n[i])},buildStep:function(t,e,r){var n=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div");return n.setAttribute("class","eform-progress-bar__step"),n.setAttribute("data-step",t),0==t?n.setAttribute("data-active","true"):n.setAttribute("data-active","false"),a.setAttribute("class","eform-progress-bar__number"),a.textContent=t+1,i.setAttribute("class","eform-progress-bar__label"),i.textContent=e,o.setAttribute("class","eform-progress-bar__line"),n.appendChild(a),n.appendChild(i),t!=r-1&&n.appendChild(o),n},addListeners:function(){document.querySelector("#ipt_fsqm_form_6_button_prev").addEventListener("click",EF_PROGRESS_BAR.updateProgressBar),document.querySelector("#ipt_fsqm_form_6_button_next").addEventListener("click",EF_PROGRESS_BAR.updateProgressBar)},getActivePanel:function(){var t=document.querySelector('.ipt_fsqm_main_tab [aria-hidden="false"]').getAttribute("id"),e=t.lastIndexOf("_")+1;return parseInt(t.slice(e))},updateProgressBar:function(){setTimeout((function(){for(var t=EF_PROGRESS_BAR.getActivePanel(),e=document.querySelectorAll(".eform-progress-bar__step"),r=0;r<e.length;r++)e[r].getAttribute("data-step")==t?e[r].setAttribute("data-active","true"):e[r].setAttribute("data-active","false")}),10)},getSectionHeadings:function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r].querySelector(".ipt_fsqm_main_heading").innerText;e.push(n)}return e}};jQuery(document).ready((function(){EF_PROGRESS_BAR.init()}));var HELP_POPUP={element:"",slides:"",footer:"",navDots:"",startBtn:"",nextBtn:"",dismissBtn:"",currentSlide:0,hideTimeout:"",cookie:{name:"rp_upload_form_help_popup",value:"viewed"},init:function(){jQuery("[data-help-popup-container]").hide(),HELP_POPUP.element=document.querySelector("[data-help-popup]"),HELP_POPUP.slides=HELP_POPUP.element.querySelectorAll("[data-slide]"),HELP_POPUP.footer=HELP_POPUP.element.querySelector("[data-help-popup-footer]"),HELP_POPUP.setSlideNumbers(),HELP_POPUP.buildNavDots(),HELP_POPUP.buildDismissButton(),HELP_POPUP.buildStartButton(),HELP_POPUP.buildNextButton(),HELP_POPUP.initHelpTriggers(),HELP_POPUP.addListeners(),HELP_POPUP.activate()},addListeners:function(){for(var t=0;t<HELP_POPUP.navDots.length;t++)HELP_POPUP.navDots[t].addEventListener("click",HELP_POPUP.changeSlide);HELP_POPUP.nextBtn.addEventListener("click",HELP_POPUP.changeSlide);for(var e=HELP_POPUP.element.querySelectorAll("[data-close]"),r=0;r<e.length;r++)e[r].addEventListener("click",HELP_POPUP.deactivate);for(var n=document.querySelectorAll("[data-help-trigger]"),a=0;a<n.length;a++)n[a].addEventListener("click",HELP_POPUP.activate)},activate:function(t){if(!TOOLBOX.getCookie(HELP_POPUP.cookie.name)||void 0!==t){if(t){HELP_POPUP.clearHideTimeout();var e=t.target.getAttribute("data-help-slide");HELP_POPUP.currentSlide=e}HELP_POPUP.updateCTAs(),HELP_POPUP.beforeAfterImgBugFix(),HELP_POPUP.setDotStates(HELP_POPUP.currentSlide),HELP_POPUP.setSlidePositions(HELP_POPUP.currentSlide),HELP_POPUP.setNextButtonTarget(HELP_POPUP.currentSlide),jQuery("[data-help-popup-container]").show(),OVERLAY.activate(),OVERLAY.activeContent.push(HELP_POPUP.deactivate),HELP_POPUP.element.setAttribute("data-active","true")}},deactivate:function(){TOOLBOX.setCookie(HELP_POPUP.cookie.name,HELP_POPUP.cookie.value,365),OVERLAY.element.setAttribute("data-overlay","inactive"),HELP_POPUP.element.setAttribute("data-active","false"),HELP_POPUP.hideTimeout=setTimeout((function(){jQuery("[data-help-popup-container]").hide()}),800)},clearHideTimeout:function(){window.clearTimeout(HELP_POPUP.hideTimeout)},buildNavDots:function(){if(HELP_POPUP.slides.length>1){var t=document.createElement("div"),e=document.createElement("ul");t.setAttribute("class","help-popup__nav-dot-container");for(var r=0;r<HELP_POPUP.slides.length;r++){var n=document.createElement("li"),a=document.createElement("a");e.setAttribute("class","help-popup__nav-dot-list"),n.setAttribute("class","help-popup__nav-dot-item"),a.setAttribute("href","#"),a.setAttribute("data-slide-target",r),n.appendChild(a),e.appendChild(n)}t.appendChild(e),HELP_POPUP.footer.appendChild(t),HELP_POPUP.navDots=e.querySelectorAll("a")}},buildStartButton:function(){if(HELP_POPUP.slides.length>1){var t=document.createElement("a");t.setAttribute("class","help-popup__start-btn | button button-primary button-small"),t.setAttribute("href","#"),t.setAttribute("data-close",""),t.textContent="Start Now",HELP_POPUP.footer.appendChild(t),HELP_POPUP.startBtn=t}},buildNextButton:function(){if(HELP_POPUP.slides.length>1){var t=document.createElement("a");t.setAttribute("class","help-popup__next-btn | button button-primary button-small"),t.setAttribute("href","#"),t.textContent="Next",HELP_POPUP.footer.appendChild(t),HELP_POPUP.nextBtn=t}},buildDismissButton:function(){if(HELP_POPUP.slides.length>1){var t=document.createElement("a");t.setAttribute("class","help-popup__dismiss-btn"),t.setAttribute("href","#"),t.setAttribute("data-close",""),t.textContent="Dismiss",HELP_POPUP.footer.appendChild(t),HELP_POPUP.dismissBtn=t}},setNextButtonTarget:function(t){t=parseInt(t);var e=HELP_POPUP.slides.length-1,r=t==e?e:t+1;HELP_POPUP.nextBtn.setAttribute("data-slide-target",r)},updateCTAs:function(){var t=HELP_POPUP.slides.length-1;0==HELP_POPUP.currentSlide?(HELP_POPUP.nextBtn.textContent="Take the tour",jQuery(HELP_POPUP.dismissBtn).show()):(HELP_POPUP.nextBtn.textContent="Next",jQuery(HELP_POPUP.dismissBtn).hide()),HELP_POPUP.currentSlide!=t?(jQuery(HELP_POPUP.startBtn).hide(),jQuery(HELP_POPUP.nextBtn).show()):(jQuery(HELP_POPUP.startBtn).show(),jQuery(HELP_POPUP.nextBtn).hide())},setSlideNumbers:function(){for(var t=0;t<HELP_POPUP.slides.length;t++)HELP_POPUP.slides[t].setAttribute("data-slide",t)},setSlidePositions:function(t){for(var e=0;e<HELP_POPUP.slides.length;e++){var r=HELP_POPUP.slides[e].getAttribute("data-slide");r==t?HELP_POPUP.slides[e].setAttribute("data-position","current"):r>t?HELP_POPUP.slides[e].setAttribute("data-position","right"):HELP_POPUP.slides[e].setAttribute("data-position","left")}},setDotStates:function(t){for(var e=0;e<HELP_POPUP.navDots.length;e++)HELP_POPUP.navDots[e].setAttribute("data-active","false");var r=t;HELP_POPUP.navDots[r].setAttribute("data-active","true")},changeSlide:function(t){var e=t.target.getAttribute("data-slide-target");HELP_POPUP.currentSlide!=e&&(HELP_POPUP.setDotStates(e),HELP_POPUP.setSlidePositions(e),HELP_POPUP.setNextButtonTarget(e),HELP_POPUP.currentSlide=e,HELP_POPUP.updateCTAs())},initHelpTriggers:function(){for(var t=document.querySelectorAll(".ipt_fsqm_form_tab_panel"),e={Upload:{helpSlide:1},Colour:{helpSlide:3},Prints:{helpSlide:4},Speed:{helpSlide:5},Review:{helpSlide:2}},r=0;r<t.length;r++){var n=t[r].querySelector(".ipt_uif_divider_text_inner").textContent;e[n=n.replace(/\s/g,"")]&&(e[n].panelID="#"+t[r].getAttribute("id"))}for(var a in e){var i=document.createElement("div");i.setAttribute("data-help-trigger",""),i.setAttribute("data-help-slide",e[a].helpSlide),i.setAttribute("class","help-popup__trigger"),document.querySelector(e[a].panelID).appendChild(i)}},beforeAfterImgBugFix:function(){var t=200,e=HELP_POPUP.element.querySelector("[data-help-before-after-img]"),r=HELP_POPUP.element.querySelector(".slider-308"),n=r.querySelector(".twentytwenty-before"),a=r.querySelector(".twentytwenty-after"),i=r.querySelector(".twentytwenty-handle"),o=n.naturalWidth,l=n.naturalHeight/o*t;e.style.width="200px",jQuery(r).attr("style","height: "+l+"px","max-width: 200px"),jQuery(n).attr("style","clip: rect(0px, 100px, "+l+"px, 0px)"),jQuery(a).attr("style","clip: rect(0px, 200px, "+l+"px, 100px)"),jQuery(i).attr("style","left: 100px")}};function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}jQuery(document).ready((function(){HELP_POPUP.init()}));var EFORM_REVIEW={panel:{id:"",el:""},dataTargets:{base:"data-",propPaths:[],tempStr:""},data:{restoration:{label:"Photo Restoration",price:EFORM.getPriceHTML(EFORM.prices.restoration)},quantity:{label:"Photos Uploaded",value:"No"},colour:{label:"Colourise:",option:null,price:null},prints:{label:"Prints:",option:"No",price:null,sizes:{label:"Sizes:",value:null}},speed:{label:"Processing Speed:",option:"Standard",price:null},subtotal:{label:"Subtotal",price:null},total:{label:"Total",price:null}},nextPanel:{id:null,timeout:null},init:function(){EFORM_REVIEW.initPanelData(),EFORM_REVIEW.constructTargetPropPaths(EFORM_REVIEW.data),EFORM_REVIEW.getNextPanel(),EFORM_REVIEW.addListeners(),EFORM_REVIEW.updateDataObj()},addListeners:function(){var t=document.querySelector(".ipt_fsqm_form_button_prev"),e=document.querySelector(".ipt_fsqm_form_button_next");t.addEventListener("click",EFORM_REVIEW.getNextPanel),e.addEventListener("click",EFORM_REVIEW.getNextPanel),e.addEventListener("click",EFORM_REVIEW.refreshSummaryTable)},initPanelData:function(){var t=EFORM.getPanelID("Review");EFORM_REVIEW.panel.id=t,EFORM_REVIEW.panel.el=document.getElementById(t)},getNextPanel:function(){var t=document.querySelectorAll(".ipt_fsqm_form_tab_panel"),e=null;EFORM_REVIEW.nextPanel.timeout=setTimeout((function(){for(var r=0;r<t.length;r++)if("false"==t[r].getAttribute("aria-hidden"))return e=r+1<t.length?t[r+1].getAttribute("id"):null,void(EFORM_REVIEW.nextPanel.id=e)}),80)},getData:{colour:{colourOption:function(){var t=document.getElementById(EFORM.getPanelID("Colour"));return EFORM_REVIEW.getOption(t)},colourPrice:function(){var t=EFORM_REVIEW.getData.colour.colourOption();return EFORM.prices.colour[t]},colourPriceHTML:function(){var t=EFORM_REVIEW.getData.colour.colourPrice();return 0==t?"-":EFORM.getPriceHTML(t)}},prints:{printsOption:function(){var t=document.getElementById(EFORM.getPanelID("Prints"));return EFORM_REVIEW.getOption(t)},sizeQty:function(){if("No"==EFORM_REVIEW.getData.prints.printsOption())return!1;for(var t=document.getElementById(EFORM.getPanelID("Prints")).querySelectorAll(".ipt_uif_sda_elem"),e=[],r=0;r<t.length;r++){var n=t[r].querySelectorAll(".check_me")[1];n=jQuery(n).val(),e[r]=parseInt(n)}return e},sizeOptions:function(){if("No"==EFORM_REVIEW.getData.prints.printsOption())return"None";var t=document.getElementById(EFORM.getPanelID("Prints")).querySelectorAll(".ipt_uif_sda_elem"),e=[];if(!t)return e;for(var r=0;r<t.length;r++){var n=t[r].querySelectorAll(".check_me")[0];n=jQuery(n).val();var a=EFORM_REVIEW.getData.prints.sizeQty()[r];e[r]=n+" ("+a+")"}return e.join(", ")},totalPrintsQty:function(){var t=EFORM_REVIEW.getData.prints.sizeQty();return t?TOOLBOX.sumArray(t):0},printsPrice:function(){var t=EFORM_REVIEW.getData.prints.printsOption();return EFORM_REVIEW.getData.prints.totalPrintsQty()*EFORM.prices.prints[t]},printsPriceHTML:function(){var t=EFORM_REVIEW.getData.prints.printsPrice(),e="";0==t?e="-":(e=EFORM.getPriceHTML(t),e+='<div class="qualifier">('+EFORM.getPriceHTML(EFORM.prices.prints.Yes)+" per print)</div>");return e}},speed:{speedOption:function(){var t=document.getElementById(EFORM.getPanelID("Speed")).querySelector(".check_me:checked");return t&&0!=t.getAttribute("value")?"Priority":"Standard"},speedPrice:function(){var t=EFORM_REVIEW.getData.speed.speedOption();return EFORM.prices.speed[t]},speedPriceHTML:function(){var t=EFORM_REVIEW.getData.speed.speedPrice();return 0==t?"-":EFORM.getPriceHTML(t)}},subtotal:{subtotalPrice:function(){var t=[EFORM.prices.restoration,EFORM_REVIEW.getData.colour.colourPrice(),EFORM_REVIEW.getData.prints.printsPrice(),EFORM_REVIEW.getData.speed.speedPrice()],e=TOOLBOX.sumArray(t);return e},subtotalPriceHTML:function(){var t=EFORM_REVIEW.getData.subtotal.subtotalPrice();return EFORM.getPriceHTML(t)}},total:{totalPrice:function(){var t=EFORM_REVIEW.getData.subtotal.subtotalPrice()*EFORM_REVIEW.data.quantity.value;return t},totalPriceHTML:function(){var t=EFORM_REVIEW.getData.total.totalPrice();return EFORM.getPriceHTML(t)}}},getOption:function(t){var e=t.querySelector(".check_me:checked");return e&&0!=e.getAttribute("value")?"Yes":"No"},constructTargetPropPaths:function(t){for(var e in t)if("object"===_typeof(t[e])&&null!==t[e])EFORM_REVIEW.dataTargets.tempStr+=e+"-",EFORM_REVIEW.constructTargetPropPaths(t[e]);else{var r=EFORM_REVIEW.dataTargets.tempStr+e;EFORM_REVIEW.dataTargets.propPaths.push(r)}EFORM_REVIEW.dataTargets.tempStr=""},fetchFromObject:function(t,e){if(void 0===t)return!1;var r=e.indexOf("-");return r>-1?EFORM_REVIEW.fetchFromObject(t[e.substring(0,r)],e.substr(r+1)):t[e]},updateDataObj:function(){EFORM_REVIEW.data.quantity.value=EFORM.getQuantity(),EFORM_REVIEW.data.colour.option=EFORM_REVIEW.getData.colour.colourOption(),EFORM_REVIEW.data.colour.price=EFORM_REVIEW.getData.colour.colourPriceHTML(),EFORM_REVIEW.data.prints.option=EFORM_REVIEW.getData.prints.printsOption(),EFORM_REVIEW.data.prints.price=EFORM_REVIEW.getData.prints.printsPriceHTML(),EFORM_REVIEW.data.prints.sizes.value=EFORM_REVIEW.getData.prints.sizeOptions(),EFORM_REVIEW.data.prints.sizes.quantity=EFORM_REVIEW.getData.prints.totalPrintsQty(),EFORM_REVIEW.data.speed.option=EFORM_REVIEW.getData.speed.speedOption(),EFORM_REVIEW.data.speed.price=EFORM_REVIEW.getData.speed.speedPriceHTML(),EFORM_REVIEW.data.subtotal.price=EFORM_REVIEW.getData.subtotal.subtotalPriceHTML(),EFORM_REVIEW.data.total.price=EFORM_REVIEW.getData.total.totalPriceHTML()},refreshSummaryTable:function(){if(EFORM_REVIEW.panel.id==EFORM_REVIEW.nextPanel.id){EFORM_REVIEW.updateDataObj();for(var t=0;t<EFORM_REVIEW.dataTargets.propPaths.length;t++){var e=EFORM_REVIEW.dataTargets.propPaths[t],r="["+EFORM_REVIEW.dataTargets.base+e+"]",n=EFORM_REVIEW.panel.el.querySelector(r),a=EFORM_REVIEW.fetchFromObject(EFORM_REVIEW.data,e);n&&(n.innerHTML=a)}"No"==EFORM_REVIEW.data.prints.option?jQuery("[data-sizes]").hide():jQuery("[data-sizes]").show()}}};jQuery(document).ready((function(){EFORM_REVIEW.init()}));